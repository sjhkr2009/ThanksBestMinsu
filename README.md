# 사용법

- 분석을 시작하려면 Program 폴더의 ThanksBestMinsu.exe 파일을 실행하세요.
  - 분석에는 1시간 ~ 1시간 30분 정도가 소요됩니다.
  - 분석 결과는 끝난 후 바탕화면에 저장됩니다. 별도의 중간저장 기능은 없으며 창을 닫으면 중단되지만, 실행 중에 다른 창에서 작업이나 게임을 해도 상관없습니다.
- 분석 없이 기록만 보려면 Sample Result 폴더에 분석한 날짜별로 파일이 있습니다.
- AnalysisOutput_result 파일에 순위가, AnalysisOutput_log 파일에는 분석 로그가 나와있습니다.
---
# 실행이 안돼요!
- 같은 폴더내에 사용하는 버전의 chromedriver.exe 가 필요합니다. 기본적으로 들어 있지만, 다른 버전의 크롬을 쓰는 경우 다운로드해서 Program 폴더에 넣어주세요.
  - 크롬 우측 상단의 메뉴 - 도움말 - Chrome 정보에서 버전 확인이 가능합니다. (예시: 버전 100.0.4896.60)
  - https://chromedriver.chromium.org/downloads 에서 사용중인 크롬 버전과 앞 자리가 동일한걸로 다운받으면 됩니다. (100.0.4896.60 이면 100으로 시작하는 버전 다운로드)
- 닷넷 6.0 버전이 필요합니다.
  - https://dotnet.microsoft.com/en-us/download/dotnet/6.0 에서 운영체제에 맞는 SDK를 다운로드할 수 있습니다.

---
# 코드를 수정해서 실행해보고 싶을 경우
- 위 실행조건과 같이 닷넷 6.0을 지원해야 합니다.
  - 비주얼 스튜디오 기준 Visual Studio 2022 이상이 필요하며 설치 시 ".NET 데스크톱 개발" 에 체크해야 합니다.
  - Selenium 모듈을 사용합니다. NuGet 패키지에서 다운받을 수 있습니다.

---
# 분석 방식
- 코드상으로는 AnalysisHelper.cs 파일 참고

---
## 시가총액
- 1000억 미만: 1000억과의 차이가 n억일 때, 루트 n 만큼 감점 (소수점 버림)
- 1조 초과: +10점

---
## PER
- PER 정보 없을 경우 당기순손실이 예상되며, -20점
- 그 외에는 동종업계 PER 정보가 없거나, 동종업계 PER이 1 미만이거나 30 초과라면 절대평가, 아니라면 상대평가

### PER - 상대평가
- 동종업계 PER과 비교해서 10% 차이마다 1점으로 점수 계산 (최대 30점)
- 동종업계 PER보다 높다면 해당 점수만큼 감점, 낮다면 가점

### PER - 절대평가
- PER 30 초과면 1.5당 -1점 (최소 -10점, PER 75 이상에서 최대 -30점)
- PER 10 미만이면 0.2당 +1점 (PER 4 이하에서 최대 +30점)

---
## 미래 PER
- PER 예상치 정보 없으면 생략
- PER 예상치 정보가 있을 경우, 현재 PER 정보가 있으면 상대평가, 없으면 절대평가

### 미래 PER - 상대평가
- 현재 PER과 비교해서 10% 차이마다 1점으로 점수 계산 (최대 10점)
- 현재 PER보다 높을 경우 해당 점수만큼 감점, 낮을 경우 가점

### 미래 PER - 절대평가
- 예상 PER 30 초과면 1.5당 -1점 (최소 -5점, 45 이상에서 최대 -10점)
- 예상 PER 10 미만이면 0.4당 +1점 (6 이하에서 최대 +10점)

---
## PBR
- 정보 없을 경우 -10점
- PBR 3 초과면, 20% 차이마다 -1점 (PBR 9 이상에서 최대 -10)
- PBR 1 미만이면, 20% 차이마다 +1점 (PBR 0.33 이하에서 최대 +10)

---
## 시가배당률
- 정보가 없거나 배당률 2% 이하면 생략
- 배당률 2% 초과일 때, 0.2%p 마다 +1점 (최소 +10, 배당률 6% 이상에서 최대 +20)

---
## 연 단위 지표분석
- 0~3년 전까지 계산, 더 과거의 정보는 조사하지 않음
  - 0년 전은 가장 최신 정보로 최근 발표한 실적 또는 올해 예상치를 의미

### 당기순이익
- 당기순손실일 경우, 3/2/1/0년 전에서 -10/20/30/40점

### 영업이익
- 영업손실일 경우, 3/2/1/0년 전에서 -10/20/30/40점
- 전년 대비 영업이익 상승 시, 1% 증가마다 +1점 (최소 10점, 최대 2/1/0년 전에서 +20/30/40점)
  - 전년이 영업손실이었다면 최소점인 10점만 부여
- 영업손실은 아니지만 전년 대비 영업이익 하락 시, 2% 하락마다 -1점 (최대 2/1/0년 점에서 -20/30/40점)

### 안정성
- 1년 전과 올해 예상치만 계산
- 부채비율이 100% 초과 시마다 -10점
- 당좌비율이 100% 미만일 때마다 -10점, 200% 초과일 때마다 +10점
- 자본유보율 500% 미만일 때마다 -5점, 2000% 초과일 때마다 +5점

---
## 분기 단위 지표분석
- 0~4분기 전까지 계산
  - 0분기 전은 이번 분기 예상지표

### 당기순이익
- 당기순손실이면 -10점